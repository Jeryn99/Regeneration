unifiedPublishing {
    project {
        displayName = "[Fabric] - Regeneration - $rootProject.minecraft_version - v$project.version"
        releaseType = "release"
        changelog = new File("${rootProject.projectDir}/changelog.html").text
        gameVersions = ["1.20.1"]
        mainPublication tasks.remapJar
        gameLoaders = ["fabric"]
        relations {
            depends {
                curseforge = "fabric-api"
                modrinth = "fabric-api"
            }
        }

        def CURSE_API_KEY = project.findProperty("curseforge") ?: System.getenv("curseforge") ?: ""
        def MODRINTH_TOKEN = project.findProperty("modrinth") ?: System.getenv("modrinth") ?: ""

        if (CURSE_API_KEY != "") {
            curseforge {
                token = CURSE_API_KEY
                id = "274275"
                gameVersions.addAll "Java 17", "1.20.1"
            }
        }

        if (MODRINTH_TOKEN != "") {
            modrinth {
                token = MODRINTH_TOKEN
                id = "8gkWtwQu"
                version = "$project.version+$project.name"
            }
        }
    }
}